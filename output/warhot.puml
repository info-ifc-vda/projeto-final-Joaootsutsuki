' Generated by UML Generator
' Encoded: fHfTSzisyjqpznyupWjToMcQJbyyrrpz8Tkwsax6SgBaUfqCJC8IpoJ10qd9QYx__NRnnGL8oUtanHPs5y1Ylx7WBtN3PDCM-Lxzc9KLawo8afpLzN7JoEo-RVWq4UKi-uD7h_QMMSgZ99D9plVs55LqAl8ygpDHdl669usGqPUzA3fCH77FccjMiWMNHq15XeYlShP1n3lr7o67y6VKMots2SVHheKFS8baoPD7jquiXIYEebluUt0KhKIMQku0dVAu-W4M5dNM0EKugbvt8o2-5oBdhDpxsXsLxAMFsJz6BXP7qJMlQo2w4WkrMoibBvj9oOiDu4HPDvesA_MItLwT7CXMFHa4UwXZP_NKh1OVqFL62zwS4WOGsx4mKjetyxZ7O2UkKIL50hiPiaSEHCcIeJBqmhTEnWvqdWi176TbGyH-p-ei0RjYoIFHopXw62Akn9hBFqlya4a-gtYUFq_QoCsaJbZ5Om9KHxzhPKc1ofAKqCuuQvRRboRIvcNQQK4jvCpdWXLSMqtQbWikogFeJF_uyvRqZ5SXXmvxsmqGLx9Ljc1esuxY9WHfewpQvfALQOuaKp9odaCTzAWV0P1k0OTzFprIXtu_TNQjp8tAE2l1tLWEuGKfAQRcJLlDbcsJYdLvASIZXroAzPpd80zk94InkFcL41M5WL6cN1fF-93nTH-97Co5p5EAChQlvD2PFY5OAk5SYnKlOEKT91Cf8PxnesZobF3A11dAyjiL-FgWsRoVAiCPuR6dvGhs4N8JX0NYhqXskkHr0q9euWH_WPhm7mIvNPEkGHq5g-BGG0Eo2yjiBpZlS7w8GxTCPiq6x0Na8DNlesW6MQPS7DWVtRcLnBM_V06pQRBaQmHXgSXAbXz5T-QNXvQSfSgkHNcIYmJosU9MWPpzELBWvbUkWY7goaCbwCjjrTS4zOM_4FxRZBh1aE-ZJ85Nfral7nYaqwU7D08_9IfsPwNiFfT2nb77vJZggLydc5d0Pf1e745dUjioaQ90hELuvDpChZtWHouFkVLt4ErqI5qZA2Q-lJw0FKN5Iqyibfaa5pNlOvn9THe8BFtw-EFdwybiTdmncIbFYdwEVaAAGi-eZwAhh6x-hhtcZLDwjs2ijCRID3PJYAzPza0ZPaADl0KhZj0J1Y9IBsriSuOXMnzma5rPInsgjs7FdCET1WnysovTqNWk9C9F8Lnx-KHZPmtBP4rJGyhh11A7YdOKpWR1UXNSu4woKbjHxDKb5deda2fEOVxTfWAztMKvxsdXLkMim6oERsRJpwTNa-DRgssmc_r_l_hnnzzU_rFzkzplJxYSdaq-dxw_dRtjJ_l7wv_oWIcpoxVp7LEM_fG7k5Nma_RX0MMlgK_QB4V-VuvAllPXyK-lNhqwwCTidQLZI52WMLQ5kMn0vohrMLTH_lvc78bcoIK09sK36OXeW2I7aalMy1d4W7lMjpQi5ZDEbp39QsYH4rZ0X6dboEEeO4_crpfBcwNvdM1QxET3Fx-f6aOTAguJoNbfwNxx_RVV1yyxT3wzZc8UZZ6uKdZavuMc5yN04rvF1eYp-WCKVQcDfh4LoCRyxxFa1rmlMSkPegQ-vl2g56fbxRkYG-E5Da1t3jR52ErbuA0fX0xuAuejeKmPB9aO3rtLL6MhN7me-OpgYgrBSmc3X1WGcgl75L_nt0XhMqa7jw8oDGlDS54dxj25044JNLjpfnfhJNOC3bJe9QUWRwktFqJ9vyIOSNp9iyMoiMMWdM-kO8gVUTOips1nLYRyMtdAoe-TUxcVMVcfWtxge5fKk7S7CvAYGFO45r1ULEXJ_ME0rO5_csbnvVFRqzAzg6jdm_ub7DAmfvzpAOepp1wO0i3ZkEIfpWB8anQJpyi8LJrZ3rojSuDfkvCdtBbW1oiJFVeqS23a0qti3FAQpDGDnRVGhaHdzpNagwJHhI8J5PINl2WXr9FezQAkeD3t89NPqjly1GZxib9SuSX4J09XgXNWXYb_u6NDEtIUhNY_aQ8vYobJ45qybap0wp4rZfQLaHdP6seDihFovm9ApJYrhf1kdFKuJLdNRjWZFsC5NbTJzI-u98tqHXYBzB56bgquK1N44EVDa43VzRZt0WeUDpwW1qPuQMxSJZCZ9tN2WT8B6MiMts5tXa2DK2WTAYGUwgCPozTNMki-WOOsnRt8kx6N7Bz5MGD9Najdvuw-wDn1T1JHoG74X37V7j_Up3nOxi81ZfwSRHzctStFNHRKtGzuhN5l-ETCMkyQ2AmlaGEZFEI0g8NmHQ2ACp9-eXhFwFs5yZTI_6aJqXo2hK4Pe1PFHDqCDCWM329r5RD2j6NphFdlTXYd2BMzriCgQy3ocesJBV3JIimm3WAXYvSBawjq8Vy49aWdmJyELq2m4J8lRxluerMXzerXIsDj70i4NS0qqbcWZGngKVCxDqifBLcUoS4TrmHc-VRSpd3kgQlZdQguzIGB5yCFTjijoaZJYUDYAydCChMLuipnk9LaIbdUIdM59nZ6Xa4AngTCoirSrI1KhYk6hKgyusdffAAzpxdo3E0nIrW-X8Datfo8igtjKjsZ05RPvW8ybDSErvnLNSaoLoDrNyUc0UPrski9S-LX8cHLyni_fvet0jM_60g5lTe3TQ_Ojwb91rswxC6kR6FEu7e4tIb6MVrMdIFkTqJYFv63klF5Wpr04soqWBUAal-tpQgAfnfq5Ed_lORARFglYMscl7v56cKklXbBq_FZjRUSgWVdfgZLfX7q_f4BCpLpnJ4HWkHOAkoYw5fadULsLWZO-NPD07RYoG69d2H6TVO73GTPVTxc-M1-rdEqo8DgBaXXzwmsuTc1_BwkglPL3qClYlqChKagHazHyydnkxStds-Ehx7pvLeBNwBlluykELjj_hRt9Tg_mDgxNWkPxe-Z_HD873cFZfyuZkPCHfUiABZ4qIcaoq98lXzz7UCQLxYpMkECBHQQvfPLcVurMmhPH3ExyAyCBYVCJhrcYonHKo7mFppelKf5U2SAjVSfJCWtTGDJeg_UkTxTJiwd7uCpxT-sTRF1YLCfIiL0mtckVcJvIlDq8VAKA-HP1k5FRtZ58LgcJAh9rvjcYQ5hN--fhDhOW5ycvFH2uYjl7FcgWvj2eBXnvAlj8EYewtfAtu_ZPsEGlat_XwtOoxR9yfTwdcUoOD6QGRmewboxEwzsvjslRSCIfpi-0MeH-1DH39qh6GiUhOVz4z4pLKe6YmZzUoZANKD9f8jX9ym2G35SrEekNlQA7jFgr7wgn6qZey4ewRyXnMZtBZFKpb1MOwQgI7XeLQfRcMgBcxQuv_stsfmbt3H8pSievS5afC6veorTrD6MBceN8Q-iGkbMFibvjorHCgf9W9igR7rX3fdsKZjTrtI0u1vy8RDKtuYLY6247qU4TJ_YFmu1FpbWA9FdTABFsvCaLPJJ7dtAA4kUgAth-Ea7ssUpFvvUMyZhxRb8jQ0EtA572IlnUUK6GkKooFi6DHFjDjI4rSqmPivxc89kuuezkW45sgKfp2vgOG-39a6rDWp-HAE4CGCh4rlCM6FeMT8rgxG1BPJnO2T7QTkgsdJ1JUWyiAPc_HdtE86oDwsLDvSe4EmFUIqoLJ-YL0On74GpY5ZpBGZzdCIgc3QfbwIdzmn-72a-dJhXJeJSaJ7oH8PhJeO7rb51LB7jgBXooGWG2Ix32X-B9EI8Db4mFE4Xw_YRUAAFsIRPARUYxiRaYWSjMwswRJuPJZuL4em4WjvVSbPmeJdB7uD6UlX0gvgAkqbC5Dz5X6dPl4trwOXgz5AxoQGo-NTRxXq-zfn9x8oQ_iTWbxZ8IjjG7cfmibfdqsCfsQP_6Q5fRCdgznMn11YVYNNPCmRlkS2sWYgcEdzgW5SjAQmhctRN6_CA7RxMg6v4LYSGk6HmDrGl7G4CcBgnmI14p6mi214J4mf2-9mFmxL0Y30yk2UKhjnNxvocs7UF8h6FCpwkFGaZ2RqlQXkBqqo2fwZxhIrBLonl-O1JZb3kwlCs9VcHbRoxAn7PZxJi7Sf9VzH9FqnIMlu1r1Q7vBmZgfM0dEgbZxAQwMEiRWQMCzhPXa7z13YKRNVAhU84ibDpvbqqZe7dYHGlMydqHncTbFlkfGEfTh8dLpDrNRik4oaJxNAHPuLwbTwJuwuqzqII2MsrhOD4imoJ4PImO74VUv1FGRzErc3bTQnUMOEaGQxd_Mzjlpiy3Bu27AOntsJqaIzVlj5bdVzngpSdH90dpm6aUTRoCMuRzH4aqjbFGXp0REV6P1S7yu_gmFIR4GViVzpeKDv7ZMJny3j6XpAVRvbFyV0mX5i3qPyo4O0zeVVP63bf3qvEtCCP3dhmhPjeTZomKqB_0nx2rZ3IxZEC9PmF4r0DcGzNa1kCr6HeEA04tS84gX_rzkW3VS05HRbZXq2xNG1MJ8KmOzNceTEIsPUimyF_EQxCez00I9kUVJuXGFrweZl90iQc0z9rFmU1ttL0qx53jWp4DWT4fpjzF_OkjLOrUtX14MQW8uyIWHQhaOSYi89m06rd93fRSPjbVi6NZ2B_Fm
' URL: http://www.plantuml.com/plantuml/uml/fHfTSzisyjqpznyupWjToMcQJbyyrrpz8Tkwsax6SgBaUfqCJC8IpoJ10qd9QYx__NRnnGL8oUtanHPs5y1Ylx7WBtN3PDCM-Lxzc9KLawo8afpLzN7JoEo-RVWq4UKi-uD7h_QMMSgZ99D9plVs55LqAl8ygpDHdl669usGqPUzA3fCH77FccjMiWMNHq15XeYlShP1n3lr7o67y6VKMots2SVHheKFS8baoPD7jquiXIYEebluUt0KhKIMQku0dVAu-W4M5dNM0EKugbvt8o2-5oBdhDpxsXsLxAMFsJz6BXP7qJMlQo2w4WkrMoibBvj9oOiDu4HPDvesA_MItLwT7CXMFHa4UwXZP_NKh1OVqFL62zwS4WOGsx4mKjetyxZ7O2UkKIL50hiPiaSEHCcIeJBqmhTEnWvqdWi176TbGyH-p-ei0RjYoIFHopXw62Akn9hBFqlya4a-gtYUFq_QoCsaJbZ5Om9KHxzhPKc1ofAKqCuuQvRRboRIvcNQQK4jvCpdWXLSMqtQbWikogFeJF_uyvRqZ5SXXmvxsmqGLx9Ljc1esuxY9WHfewpQvfALQOuaKp9odaCTzAWV0P1k0OTzFprIXtu_TNQjp8tAE2l1tLWEuGKfAQRcJLlDbcsJYdLvASIZXroAzPpd80zk94InkFcL41M5WL6cN1fF-93nTH-97Co5p5EAChQlvD2PFY5OAk5SYnKlOEKT91Cf8PxnesZobF3A11dAyjiL-FgWsRoVAiCPuR6dvGhs4N8JX0NYhqXskkHr0q9euWH_WPhm7mIvNPEkGHq5g-BGG0Eo2yjiBpZlS7w8GxTCPiq6x0Na8DNlesW6MQPS7DWVtRcLnBM_V06pQRBaQmHXgSXAbXz5T-QNXvQSfSgkHNcIYmJosU9MWPpzELBWvbUkWY7goaCbwCjjrTS4zOM_4FxRZBh1aE-ZJ85Nfral7nYaqwU7D08_9IfsPwNiFfT2nb77vJZggLydc5d0Pf1e745dUjioaQ90hELuvDpChZtWHouFkVLt4ErqI5qZA2Q-lJw0FKN5Iqyibfaa5pNlOvn9THe8BFtw-EFdwybiTdmncIbFYdwEVaAAGi-eZwAhh6x-hhtcZLDwjs2ijCRID3PJYAzPza0ZPaADl0KhZj0J1Y9IBsriSuOXMnzma5rPInsgjs7FdCET1WnysovTqNWk9C9F8Lnx-KHZPmtBP4rJGyhh11A7YdOKpWR1UXNSu4woKbjHxDKb5deda2fEOVxTfWAztMKvxsdXLkMim6oERsRJpwTNa-DRgssmc_r_l_hnnzzU_rFzkzplJxYSdaq-dxw_dRtjJ_l7wv_oWIcpoxVp7LEM_fG7k5Nma_RX0MMlgK_QB4V-VuvAllPXyK-lNhqwwCTidQLZI52WMLQ5kMn0vohrMLTH_lvc78bcoIK09sK36OXeW2I7aalMy1d4W7lMjpQi5ZDEbp39QsYH4rZ0X6dboEEeO4_crpfBcwNvdM1QxET3Fx-f6aOTAguJoNbfwNxx_RVV1yyxT3wzZc8UZZ6uKdZavuMc5yN04rvF1eYp-WCKVQcDfh4LoCRyxxFa1rmlMSkPegQ-vl2g56fbxRkYG-E5Da1t3jR52ErbuA0fX0xuAuejeKmPB9aO3rtLL6MhN7me-OpgYgrBSmc3X1WGcgl75L_nt0XhMqa7jw8oDGlDS54dxj25044JNLjpfnfhJNOC3bJe9QUWRwktFqJ9vyIOSNp9iyMoiMMWdM-kO8gVUTOips1nLYRyMtdAoe-TUxcVMVcfWtxge5fKk7S7CvAYGFO45r1ULEXJ_ME0rO5_csbnvVFRqzAzg6jdm_ub7DAmfvzpAOepp1wO0i3ZkEIfpWB8anQJpyi8LJrZ3rojSuDfkvCdtBbW1oiJFVeqS23a0qti3FAQpDGDnRVGhaHdzpNagwJHhI8J5PINl2WXr9FezQAkeD3t89NPqjly1GZxib9SuSX4J09XgXNWXYb_u6NDEtIUhNY_aQ8vYobJ45qybap0wp4rZfQLaHdP6seDihFovm9ApJYrhf1kdFKuJLdNRjWZFsC5NbTJzI-u98tqHXYBzB56bgquK1N44EVDa43VzRZt0WeUDpwW1qPuQMxSJZCZ9tN2WT8B6MiMts5tXa2DK2WTAYGUwgCPozTNMki-WOOsnRt8kx6N7Bz5MGD9Najdvuw-wDn1T1JHoG74X37V7j_Up3nOxi81ZfwSRHzctStFNHRKtGzuhN5l-ETCMkyQ2AmlaGEZFEI0g8NmHQ2ACp9-eXhFwFs5yZTI_6aJqXo2hK4Pe1PFHDqCDCWM329r5RD2j6NphFdlTXYd2BMzriCgQy3ocesJBV3JIimm3WAXYvSBawjq8Vy49aWdmJyELq2m4J8lRxluerMXzerXIsDj70i4NS0qqbcWZGngKVCxDqifBLcUoS4TrmHc-VRSpd3kgQlZdQguzIGB5yCFTjijoaZJYUDYAydCChMLuipnk9LaIbdUIdM59nZ6Xa4AngTCoirSrI1KhYk6hKgyusdffAAzpxdo3E0nIrW-X8Datfo8igtjKjsZ05RPvW8ybDSErvnLNSaoLoDrNyUc0UPrski9S-LX8cHLyni_fvet0jM_60g5lTe3TQ_Ojwb91rswxC6kR6FEu7e4tIb6MVrMdIFkTqJYFv63klF5Wpr04soqWBUAal-tpQgAfnfq5Ed_lORARFglYMscl7v56cKklXbBq_FZjRUSgWVdfgZLfX7q_f4BCpLpnJ4HWkHOAkoYw5fadULsLWZO-NPD07RYoG69d2H6TVO73GTPVTxc-M1-rdEqo8DgBaXXzwmsuTc1_BwkglPL3qClYlqChKagHazHyydnkxStds-Ehx7pvLeBNwBlluykELjj_hRt9Tg_mDgxNWkPxe-Z_HD873cFZfyuZkPCHfUiABZ4qIcaoq98lXzz7UCQLxYpMkECBHQQvfPLcVurMmhPH3ExyAyCBYVCJhrcYonHKo7mFppelKf5U2SAjVSfJCWtTGDJeg_UkTxTJiwd7uCpxT-sTRF1YLCfIiL0mtckVcJvIlDq8VAKA-HP1k5FRtZ58LgcJAh9rvjcYQ5hN--fhDhOW5ycvFH2uYjl7FcgWvj2eBXnvAlj8EYewtfAtu_ZPsEGlat_XwtOoxR9yfTwdcUoOD6QGRmewboxEwzsvjslRSCIfpi-0MeH-1DH39qh6GiUhOVz4z4pLKe6YmZzUoZANKD9f8jX9ym2G35SrEekNlQA7jFgr7wgn6qZey4ewRyXnMZtBZFKpb1MOwQgI7XeLQfRcMgBcxQuv_stsfmbt3H8pSievS5afC6veorTrD6MBceN8Q-iGkbMFibvjorHCgf9W9igR7rX3fdsKZjTrtI0u1vy8RDKtuYLY6247qU4TJ_YFmu1FpbWA9FdTABFsvCaLPJJ7dtAA4kUgAth-Ea7ssUpFvvUMyZhxRb8jQ0EtA572IlnUUK6GkKooFi6DHFjDjI4rSqmPivxc89kuuezkW45sgKfp2vgOG-39a6rDWp-HAE4CGCh4rlCM6FeMT8rgxG1BPJnO2T7QTkgsdJ1JUWyiAPc_HdtE86oDwsLDvSe4EmFUIqoLJ-YL0On74GpY5ZpBGZzdCIgc3QfbwIdzmn-72a-dJhXJeJSaJ7oH8PhJeO7rb51LB7jgBXooGWG2Ix32X-B9EI8Db4mFE4Xw_YRUAAFsIRPARUYxiRaYWSjMwswRJuPJZuL4em4WjvVSbPmeJdB7uD6UlX0gvgAkqbC5Dz5X6dPl4trwOXgz5AxoQGo-NTRxXq-zfn9x8oQ_iTWbxZ8IjjG7cfmibfdqsCfsQP_6Q5fRCdgznMn11YVYNNPCmRlkS2sWYgcEdzgW5SjAQmhctRN6_CA7RxMg6v4LYSGk6HmDrGl7G4CcBgnmI14p6mi214J4mf2-9mFmxL0Y30yk2UKhjnNxvocs7UF8h6FCpwkFGaZ2RqlQXkBqqo2fwZxhIrBLonl-O1JZb3kwlCs9VcHbRoxAn7PZxJi7Sf9VzH9FqnIMlu1r1Q7vBmZgfM0dEgbZxAQwMEiRWQMCzhPXa7z13YKRNVAhU84ibDpvbqqZe7dYHGlMydqHncTbFlkfGEfTh8dLpDrNRik4oaJxNAHPuLwbTwJuwuqzqII2MsrhOD4imoJ4PImO74VUv1FGRzErc3bTQnUMOEaGQxd_Mzjlpiy3Bu27AOntsJqaIzVlj5bdVzngpSdH90dpm6aUTRoCMuRzH4aqjbFGXp0REV6P1S7yu_gmFIR4GViVzpeKDv7ZMJny3j6XpAVRvbFyV0mX5i3qPyo4O0zeVVP63bf3qvEtCCP3dhmhPjeTZomKqB_0nx2rZ3IxZEC9PmF4r0DcGzNa1kCr6HeEA04tS84gX_rzkW3VS05HRbZXq2xNG1MJ8KmOzNceTEIsPUimyF_EQxCez00I9kUVJuXGFrweZl90iQc0z9rFmU1ttL0qx53jWp4DWT4fpjzF_OkjLOrUtX14MQW8uyIWHQhaOSYi89m06rd93fRSPjbVi6NZ2B_Fm
' Generated on: 2025-12-08T23:22:15.048370800

@startuml
skinparam classAttributeIconSize 0
hide circle

class CollisionDetector {
  -combatManager: CombatManager
  -player: Player
  --
  +CollisionDetector(player: Player, combatManager: CombatManager)
  +checkCollision(room: Room): void
  -collide(p1: Position, p2: Position): boolean
}

class CombatManager {
  -player: Player
  -log: MessageLog
  -currentEnemy: Monster
  -inCombat: boolean
  --
  +CombatManager(player: Player, log: MessageLog)
  +isInCombat(): boolean
  +getCurrentEnemy(): Monster
  +startCombat(enemy: Monster): void
  +processCombat(key: char, currentRoom: Room, currentFloor: int): void
  -basicAttack(room: Room, floor: int): void
  -powerAttack(room: Room, floor: int): void
  -fireSpell(room: Room, floor: int): void
  -tryEscape(): void
  -enemyTurn(): void
  -checkEnemyDeath(room: Room, floor: int): boolean
  +endCombat(): void
}

class Game {
  -dungeon: Dungeon
  -player: Player
  -log: MessageLog
  -combatManager: CombatManager
  -roomManager: RoomManager
  -navigationManager: NavigationManager
  -inputHandler: InputHandler
  -collisionDetector: CollisionDetector
  -gameUI: GameUI
  --
  +start(): void
  -initializeGame(): void
  -setupShutdownHook(): void
  -showWelcomeMessage(): void
  -gameLoop(): void
  -renderCurrentView(): void
  -renderGameWorld(): void
  -processInput(key: char): void
  -handleMovement(key: char): void
  -handleError(e: Exception): void
  -gameOver(): void
}

class GameUI {
  +showInventory(player: Player): void
  +showChestLoot(chest: Chest, player: Player): void
  +showMinimap(dungeon: Dungeon): void
  +showGameOver(player: Player, currentFloor: int): void
  -getRarityColor(rarity: String): String
}

class Input {
  -{static} terminal: Terminal
  -{static} reader: NonBlockingReader
  --
  +{static} getKey(): char
  +{static} cleanup(): void
}

class InputHandler {
  -player: Player
  -log: MessageLog
  -ui: GameUI
  -dungeon: Dungeon
  -showingInventory: boolean
  -showingChestLoot: boolean
  -currentChest: Chest
  --
  +InputHandler(player: Player, log: MessageLog, ui: GameUI, dungeon: Dungeon)
  +isShowingInventory(): boolean
  +isShowingChestLoot(): boolean
  +getCurrentChest(): Chest
  +processInventory(key: char): void
  +processChestLoot(key: char): void
  +processMovement(key: char): void
  -checkChest(room: Room): void
  -collide(p1: Position, p2: Position): boolean
  +openInventory(): void
  +closeInventory(): void
}

class MessageLog {
  -{static} MAX_MESSAGES: int = 5
  -messages: List<String>
  --
  +MessageLog()
  +add(message: String): void
  +getMessages(): List<String>
  +clear(): void
}

class NavigationManager {
  -player: Player
  -dungeon: Dungeon
  -log: MessageLog
  -roomManager: RoomManager
  --
  +NavigationManager(player: Player, dungeon: Dungeon, log: MessageLog, roomManager: RoomManager)
  +checkForRoomChange(): void
  +checkStairs(): void
  -descendFloor(): void
  -ascendFloor(): void
  +checkRoomTransition(): void
  -transitionToRoom(doorType: Tile): void
}

class Render {
  -{static} ANSI_CLEAR: String = "\033[2J\033[H"
  -{static} ANSI_HIDE_CURSOR: String = "\033[?25l"
  -{static} ANSI_SHOW_CURSOR: String = "\033[?25h"
  -{static} frameBuffer: StringBuilder = new StringBuilder(5000)
  --
  +{static} render(map: Map, player: Player, log: MessageLog, chests: List<Chest>, others: Entity): void
  -{static} generateSidebar(player: Player, enemies: Entity): String
  -{static} generateBar(current: int, max: int, width: int, color: String): String
  -{static} renderChests(screen: String[][], chests: List<Chest>): void
  -{static} renderEntities(screen: String[][], player: Player, others: Entity): void
  -{static} renderLog(log: MessageLog): void
  -{static} isValidPosition(x: int, y: int, screen: String[][]): boolean
  +{static} clearScreen(): void
  +{static} showCursor(): void
  +{static} hideCursor(): void
}

class RoomManager {
  -rand: Random
  -log: MessageLog
  --
  +RoomManager(log: MessageLog)
  +setupRoom(room: Room): void
  +spawnMonstersInRoom(room: Room, floorLevel: int, player: Player): void
  -findMonsterSpawnPosition(map: Map, playerPos: Position, usedPositions: List<Position>, monsterIndex: int, zoneWidth: int, zoneHeight: int): Position
  -trySpawnWithDistance(map: Map, playerPos: Position, usedPositions: List<Position>, minX: int, maxX: int, minY: int, maxY: int, minPlayerDist: int, minMonsterDist: int, maxAttempts: int): Position
  -createMonster(pos: Position, floorLevel: int, boss: boolean): Monster
  +getSpawnPositionFromDoor(doorEntered: Tile, map: Map): Position
  +findSafeSpawnNear(map: Map, targetX: int, targetY: int): Position
  +getRoomDescription(room: Room): String
}

abstract class Entity {
  #name: String
  #sprite: String
  #position: Position
  #maxHp: int
  #currentHp: int
  #attack: int
  #defense: int
  #alive: boolean
  --
  +Entity(name: String, sprite: String[][], position: Position, hp: int, attack: int, defense: int)
  +move(dx: int, dy: int, map: Map): void
  +takeDamage(damage: int): void
  +attack(): int
  +position(): Position
  +setPosition(newPosition: Position): void
  +sprite(): String[][]
  +name(): String
  +currentHp(): int
  +maxHp(): int
  +attackPower(): int
  +defense(): int
  +alive(): boolean
}

class Monster {
  +Monster(name: String, symbol: String, color: String, position: Position, hp: int, attack: int, defense: int)
  -{static} generateSprite(symbol: String, color: String): String[][]
}

class Player {
  -maxMana: int
  -currentMana: int
  -level: int
  -xp: int
  -inventory: Inventory
  -stats: Stats
  --
  +Player(name: String, position: Position)
  +maxMana(): int
  +currentMana(): int
  +level(): int
  +xp(): int
  +inventory(): Inventory
  +stats(): Stats
  +spendMana(cost: int): boolean
  +gainXp(amount: int): void
  +attack(): int
  +takeDamage(damage: int): void
}

class Stats {
  -vitality: int
  -endurance: int
  -strength: int
  -dexterity: int
  -intelligence: int
  -luck: int
  --
  +Stats(vit: int, end: int, str: int, dex: int, intel: int, lck: int)
  +vitality(): int
  +endurance(): int
  +strength(): int
  +dexterity(): int
  +intelligence(): int
  +luck(): int
  +addVitality(amount: int): void
  +addEndurance(amount: int): void
  +addStrength(amount: int): void
  +addDexterity(amount: int): void
  +addIntelligence(amount: int): void
  +addLuck(amount: int): void
  +maxHp(): int
  +maxCarryWeight(): int
  +evasionChance(): double
  +criticalChance(): double
  +lootBonus(): int
}

class Chest {
  -position: Position
  -weapons: List<Weapon>
  -opened: boolean
  -sprite: String
  -corpseName: String
  --
  +Chest(position: Position, floorLevel: int, luckBonus: int, monsterName: String)
  +position(): Position
  +weapons(): List<Weapon>
  +isOpened(): boolean
  +open(): void
  +sprite(): String[][]
  +corpseName(): String
}

class Inventory {
  -weapons: List<Weapon>
  -equippedWeapon: Weapon
  -{static} MAX_SIZE: int = 20
  --
  +Inventory()
  +addWeapon(weapon: Weapon, maxWeight: double): boolean
  +equipWeapon(index: int): void
  +removeWeapon(index: int): void
  +getCurrentWeight(): double
  +getWeapons(): List<Weapon>
  +getEquippedWeapon(): Weapon
  +size(): int
  +isFull(): boolean
}

class Weapon {
  -name: String
  -level: int
  -baseDamage: int
  -rarity: String
  -type: WeaponType
  -weight: double
  -{static} WEAPON_NAMES: String = { // Heavy
{ "Greatsword", "Battle Axe", "War Hammer", "Claymore" }, // Light
{ "Dagger", "Rapier", "Short Sword", "Katana" }, // Magic
{ "Staff", "Wand", "Tome", "Catalyst" } }
  -{static} PREFIXES: String = { "Rusty", "Iron", "Steel", "Silver", "Golden", "Diamond", "Legendary", "Mythical" }
  --
  +Weapon(name: String, level: int, baseDamage: int, rarity: String, type: WeaponType, weight: double)
  +{static} generateRandom(floorLevel: int, luckBonus: int, rand: java.util.Random): Weapon
  +getDamageWithStats(str: int, dex: int, intel: int): int
  +name(): String
  +level(): int
  +baseDamage(): int
  +rarity(): String
  +type(): WeaponType
  +weight(): double
  +getTypeSymbol(): String
  +toString(): String
}

class Main {
  +{static} main(args: String[]): void
}

class Dungeon {
  -floors: List<DungeonLevel>
  -currentFloor: int
  -rand: Random
  --
  +Dungeon()
  -generateFloor(floorNumber: int): void
  -placeStairs(floor: DungeonLevel, floorNumber: int): void
  +descendFloor(): void
  +ascendFloor(): void
  +getCurrentLevel(): DungeonLevel
  +getCurrentFloorNumber(): int
  +getTotalFloorsGenerated(): int
}

class DungeonLevel {
  -roomGrid: Room
  -gridSize: int
  -currentRoomX: int
  -currentRoomY: int
  -floorNumber: int
  -rand: Random
  --
  +DungeonLevel(floorNumber: int)
  -generateDungeon(): void
  -connectRooms(x1: int, y1: int, x2: int, y2: int): void
  +getCurrentRoom(): Room
  +canMoveNorth(): boolean
  +canMoveSouth(): boolean
  +canMoveEast(): boolean
  +canMoveWest(): boolean
  +moveNorth(): void
  +moveSouth(): void
  +moveEast(): void
  +moveWest(): void
  +floorNumber(): int
  +currentRoomX(): int
  +currentRoomY(): int
  +roomGrid(): Room[][]
  +gridSize(): int
}

class Map {
  -grid: Tile
  -r: Random = new Random()
  -rooms: List<RoomBounds>
  -northDoorPos: Position
  -southDoorPos: Position
  -eastDoorPos: Position
  -westDoorPos: Position
  --
  +Map(width: int, height: int)
  +Map(width: int, height: int, north: boolean, south: boolean, east: boolean, west: boolean)
  +getTile(y: int, x: int): Tile
  +getHeight(): int
  +getWidth(): int
  +placeDoors(north: boolean, south: boolean, east: boolean, west: boolean): void
  -generateRooms(): void
  -carveRoom(room: RoomBounds): void
  -connectRooms(): void
  -carveCorridor(x1: int, y1: int, x2: int, y2: int): void
  +canWalk(x: int, y: int): boolean
  +isDoor(x: int, y: int): boolean
  +isStairs(x: int, y: int): boolean
  +getDoorType(x: int, y: int): Tile
  +getStairsType(x: int, y: int): Tile
  +randomPosition(): Position
  +randomPositionFarFromPlayer(playerPos: Position, minDistance: int): Position
  +asStringArray(): String[][]
  +placeStairs(hasUp: boolean, hasDown: boolean): void
}

class Room {
  -mapa: Map
  -monstros: List<Monster>
  -chests: List<Chest>
  -discovered: boolean
  -cleared: boolean
  -hasNorthDoor: boolean
  -hasSouthDoor: boolean
  -hasEastDoor: boolean
  -hasWestDoor: boolean
  -hasStairsUp: boolean
  -hasStairsDown: boolean
  -type: RoomType
  --
  +Room(type: RoomType)
  +generateMap(): void
  +setDoor(direction: String, value: boolean): void
  +mapa(): Map
  +monstros(): List<Monster>
  +chests(): List<Chest>
  +discovered(): boolean
  +cleared(): boolean
  +type(): RoomType
  +hasNorthDoor(): boolean
  +hasSouthDoor(): boolean
  +hasEastDoor(): boolean
  +hasWestDoor(): boolean
  +hasStairsUp(): boolean
  +hasStairsDown(): boolean
  +setDiscovered(value: boolean): void
  +setCleared(value: boolean): void
  +setStairsUp(value: boolean): void
  +setStairsDown(value: boolean): void
  +checkCleared(): void
}

class RoomBounds {
  -x: int
  -y: int
  -width: int
  -height: int
  --
  +RoomBounds(x: int, y: int, width: int, height: int)
  +x(): int
  +y(): int
  +width(): int
  +height(): int
  +centerX(): int
  +centerY(): int
  +intersects(other: RoomBounds): boolean
}

CollisionDetector *-- CombatManager
CollisionDetector *-- Player
CollisionDetector ..> Room
CombatManager *-- Player
CombatManager *-- MessageLog
CombatManager *-- Monster
CombatManager ..> Room
Game *-- Dungeon
Game *-- Player
Game *-- MessageLog
Game *-- CombatManager
Game *-- RoomManager
Game *-- NavigationManager
Game *-- InputHandler
Game *-- CollisionDetector
Game *-- GameUI
GameUI ..> Player
GameUI ..> Chest
GameUI ..> Dungeon
InputHandler *-- Player
InputHandler *-- MessageLog
InputHandler *-- GameUI
InputHandler *-- Dungeon
InputHandler *-- Chest
InputHandler ..> Room
NavigationManager *-- Player
NavigationManager *-- Dungeon
NavigationManager *-- MessageLog
NavigationManager *-- RoomManager
Render ..> Map
Render ..> Player
Render ..> MessageLog
Render ..> Entity
RoomManager *-- MessageLog
RoomManager ..> Room
RoomManager ..> Player
RoomManager ..> Map
RoomManager ..> Monster
Entity ..> Map
Monster --|> Entity
Player --|> Entity
Player *-- Inventory
Player *-- Stats
Chest o-- Weapon
Inventory o-- Weapon
Inventory *-- Weapon
Weapon ..> Weapon
Dungeon o-- DungeonLevel
DungeonLevel *-- Room
Map o-- RoomBounds
Room *-- Map
Room o-- Monster
Room o-- Chest
RoomBounds ..> RoomBounds
@enduml